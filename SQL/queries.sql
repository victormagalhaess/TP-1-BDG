select b.codigo_snisb, r.sigla, b.geom from barragem as b, rodovias as r where st_distance(st_transform(b.geom, 26915), st_transform(r.geom, 26915)) < 10000 /*QUERY: BARRAGENS A MENOS DE 10KM DE UMA RODOVIA*/
select b.uf, b.geom from barragem as b where b.uf in ( select uf from barragem group by uf having count(uf)=(select max(a.cnt) from (select count(uf) as cnt from barragem group by (UF)) as A)) /*QUERY: BARRAGENS NO ESTADO COM MAIOR NÚMERO DE BARRAGENS*/
select b.uf, b.geom from barragem as b where b.cat_risco = 'Alto' and b.uf = (select uf from (select count(uf) as cnt, uf from barragem where cat_risco = 'Alto' group by (UF) order by cnt desc) as total limit 1) /*QUERY: BARRAGENS DE ALTO RISCO NO ESTADO COM MAIS BARRAGENS DE ALTO RISCO */
select r.sigla, r.geom from barragem as b, rodovias as r where st_distance(st_transform(b.geom, 26915), st_transform(r.geom, 26915)) < 10000 and b.cat_risco = 'Alto' /*QUERY: RODOVIAS A MENOS DE 10KM DE BARRAGENS DE ALTO RISCO*/
select count(bh.gid) as total_barragens, bh.geom from bacia_hidrografica as bh, barragem as b WHERE (st_contains(bh.geom, b.geom)) group by bh.gid, bh.geom order by total_barragens desc limit 1 /*QUERY: BACIA HIDROGRÁFICA COM MAIS BARRAGENS*/
